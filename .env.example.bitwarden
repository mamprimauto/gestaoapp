# =============================================================================
# CONFIGURAÇÕES DO BITWARDEN - SISTEMA DE SENHAS SEGURO
# =============================================================================

# ===== CONFIGURAÇÕES OBRIGATÓRIAS =====

# Credenciais da API do Bitwarden
# Obter em: https://bitwarden.com/help/personal-api-key/
BITWARDEN_CLIENT_ID="user.xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"
BITWARDEN_CLIENT_SECRET="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"

# ID da Organização (se usando Bitwarden Business)
# Obter em: Settings > Organizations > View Organization
BITWARDEN_ORG_ID="xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"

# ===== CONFIGURAÇÕES OPCIONAIS DE SEGURANÇA =====

# Habilitar senha mestre adicional (além do Bitwarden)
# Valores: "true" ou "false" (padrão: false)
REQUIRE_MASTER_PASSWORD="false"

# Senha mestre global (se REQUIRE_MASTER_PASSWORD=true)
# IMPORTANTE: Use uma senha forte e única
MASTER_PASSWORD="sua-senha-mestre-super-segura"

# Salt para hash de senhas mestras
# IMPORTANTE: Gere um valor aleatório de 32 caracteres
MASTER_PASSWORD_SALT="abcdef1234567890abcdef1234567890"

# Chave de criptografia para dados sensíveis
# IMPORTANTE: Gere um valor aleatório de 32 caracteres
ENCRYPTION_KEY="1234567890abcdef1234567890abcdef"

# Segredo para sessões
# IMPORTANTE: Gere um valor aleatório de 32 caracteres
SESSION_SECRET="fedcba0987654321fedcba0987654321"

# ===== CONFIGURAÇÕES DE URLS (para self-hosted) =====

# URL da API do Bitwarden (padrão: Bitwarden Cloud)
BITWARDEN_API_URL="https://api.bitwarden.com"

# URL do serviço de identidade (padrão: Bitwarden Cloud)
BITWARDEN_IDENTITY_URL="https://identity.bitwarden.com"

# Para Bitwarden self-hosted (Vaultwarden), use:
# BITWARDEN_API_URL="https://seu-vaultwarden.com/api"
# BITWARDEN_IDENTITY_URL="https://seu-vaultwarden.com/identity"

# ===== CONFIGURAÇÕES DE MONITORAMENTO =====

# Webhook para alertas de segurança (Slack, Discord, etc.)
ADMIN_WEBHOOK_URL="https://hooks.slack.com/services/xxx/yyy/zzz"

# Email para alertas críticos
ADMIN_EMAIL="admin@suaempresa.com"

# ===== CONFIGURAÇÕES DE RATE LIMITING =====

# Redis URL para rate limiting distribuído (opcional)
# Se não configurado, usa cache em memória
REDIS_URL="redis://localhost:6379"

# ===== LOGS E AUDITORIA =====

# Nível de log (debug, info, warn, error)
LOG_LEVEL="info"

# Habilitar logs detalhados de auditoria
ENABLE_AUDIT_LOGS="true"

# Retenção de logs em dias
AUDIT_LOG_RETENTION_DAYS="90"

# =============================================================================
# INSTRUÇÕES DE SETUP
# =============================================================================

# 1. Crie uma conta Bitwarden Business em: https://bitwarden.com/pricing/business/
# 2. Configure sua organização e adicione usuários
# 3. Gere API Keys em: Settings > Security > API Key
# 4. Copie este arquivo para .env.local e preencha as variáveis
# 5. Para valores aleatórios, use: node -e "console.log(require('crypto').randomBytes(16).toString('hex'))"

# =============================================================================
# CONSIDERAÇÕES DE SEGURANÇA
# =============================================================================

# ✅ FAÇA:
# - Use HTTPS em produção
# - Configure CORS adequadamente
# - Habilite 2FA para todos os usuários do Bitwarden
# - Monitore logs de auditoria regularmente
# - Faça backup das configurações
# - Use senhas mestras fortes e únicas
# - Rotacione chaves regulamente (trimestral)

# ❌ NÃO FAÇA:
# - Commitar este arquivo com valores reais
# - Usar senhas fracas
# - Compartilhar credenciais por email/chat
# - Desabilitar rate limiting em produção
# - Ignorar alertas de segurança
# - Usar HTTP em produção

# =============================================================================
# TROUBLESHOOTING
# =============================================================================

# Erro: "Authentication failed"
# - Verifique BITWARDEN_CLIENT_ID e CLIENT_SECRET
# - Confirme que a API Key está ativa no Bitwarden

# Erro: "Organization not found"
# - Verifique BITWARDEN_ORG_ID
# - Confirme que o usuário tem acesso à organização

# Erro: "Too many requests"
# - Aguarde alguns minutos
# - Verifique se não há múltiplas instâncias rodando

# Para suporte: consulte a documentação em /docs/bitwarden-setup.md